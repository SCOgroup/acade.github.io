{{ $person := . }}
{{ $avatar := partial "get-avatar" . }}

<div class="col">
  <div class="card h-100 shadow-sm border-0 hover-shadow transition">
    <div class="card-body text-center p-4">
      {{/* 头像 - 修复 onerror 语法 */}}
      <div class="mb-3 mx-auto" style="width: 120px; height: 120px;">
        {{ if $avatar }}
          <img src="{{ $avatar }}" alt="{{ $person.Title }}" 
               class="rounded-circle w-100 h-100 object-fit-cover"
               onerror="this.onerror=null; this.replaceWith((function(){var div=document.createElement('div');div.className='d-flex align-items-center justify-content-center rounded-circle bg-light text-muted w-100 h-100';div.textContent='无头像';return div;})())">
        {{ else }}
          <div class="d-flex align-items-center justify-content-center rounded-circle bg-light text-muted w-100 h-100">
            无头像
          </div>
        {{ end }}
      </div>
      
      {{/* 姓名 */}}
      <h3 class="h5 card-title mb-2">{{ $person.Title }}</h3>
      
      {{/* 角色和毕业年份 */}}
      <div class="text-muted mb-3">
        {{ $person.Params.role }}
        {{ with $person.Params.group }}
          <span class="ms-1">({{ . }}组)</span>
        {{ end }}
      </div>
      
      {{/* 研究兴趣 */}}
      {{ with $person.Params.interests }}
        <div class="card-text">
          <div class="fw-bold mb-2">研究方向：</div>
          <div class="d-flex flex-wrap justify-content-center gap-1">
            {{ range . }}
              <span class="badge bg-primary bg-opacity-10 text-primary">{{ . }}</span>
            {{ end }}
          </div>
        </div>
      {{ end }}
    </div>
    
    {{/* 毕业学校 */}}
    {{ with index $person.Params.organizations 0 }}
      <div class="card-footer bg-transparent border-0 text-center pt-0 pb-3">
        <span class="text-muted">{{ .name }}</span>
      </div>
    {{ end }}
  </div>
</div>
